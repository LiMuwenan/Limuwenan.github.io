<?xml version="1.0" encoding="UTF8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cn.edu.xidian.dao.TeacherMapper">

    <select id="getTeacherList" resultType="Teacher">
        select * from mybatis.teacher
    </select>

    <!--按结果嵌套查询-->
    <resultMap id="TeacherMap" type="Teacher">
        <result column="tid" property="tech_id"/>
        <result column="tname" property="tech_name"/>
        <!--集合泛型的值，使用ofType-->
        <collection property="student" column="student" ofType="Student">
            <result column="sid" property="stu_id"/>
            <result column="sname" property="stu_name"/>
        </collection>
    </resultMap>
    <select id="getTeacherByIdIncludeStudent" resultType="Teacher" parameterType="int" resultMap="TeacherMap">
        select s.stu_id as sid,s.stu_name as sname,t.tech_id as tid ,t.tech_name as tname
        from mybatis.teacher as t,student as s  where stu_tid = tech_id and tech_id = #{tech_id}
    </select>

<!--    子查询方式-->
    <select id="getTeacherByIdIncludeStudent2" resultMap="TeacherMap2" resultType="Teacher">
        select * from mybatis.teacher where tech_id = #{tech_id}
    </select>

    <resultMap id="TeacherMap2" type="Teacher">
        <!--集合泛型的值，使用ofType-->
        <collection property="student" column="tech_id" javaType="ArrayList" ofType="Student" select="getStudent">
        </collection>
    </resultMap>

    <select id="getStudent" resultType="Student">
        select * from student where stu_tid = #{tech_id}
    </select>
</mapper>