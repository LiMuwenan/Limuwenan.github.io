# 1 语法

## 1.1 普通字符

普通字符为没有显式指定为元字符的所有可打印和不可打印字符。

|     字符      |                             说明                             |
| :-----------: | :----------------------------------------------------------: |
|     [ABC]     |                匹配中括号([...])中的所有字符                 |
|    [^ABC]     |           匹配除了中括号([...])中的字符的所有字符            |
|     [A-Z]     |      匹配区间A-Z中的所有字符，这里可以使小写字母和数字       |
|  .(英文小点)  |    匹配除换行符(\n,\r)之外的任何单个字符，相当于\[^\n\r]     |
|    [\s\S]     | 匹配所有。\s是匹配所有的空白符，包括换行；\S是匹配非空白符，不包括换行 |
|      \w       |          匹配字母，数字，下划线。等价于[0-9a-zA-Z_]          |
| \u4e00-\u9fa5 |                             汉字                             |

## 1.2 非打印字符

| 字符 |                             说明                             |
| :--: | :----------------------------------------------------------: |
| \cx  | 匹配由x指明的控制字符。例如， \cM 匹配一个 Control-M 或回车符。x 的值必须为 A-Z 或 a-z 之一。否则，将 c 视为一个原义的 'c' 字符。 |
|  \f  |               匹配一个换页符。等价于\x0c和\cL                |
|  \n  |               匹配一个换行符。等价于\x0a和\cJ                |
|  \r  |               匹配一个回车符。等价于\x0d和\cM                |
|  \s  | 匹配任何空白字符，包括空格、制表符、换页符等等。等价于[\f\n\r\t\v]。 |
|  \S  |          匹配任何非空白字符。等价于[\^\f\n\r\t\v]。          |
|  \t  |               匹配一个制表符。等价于\x09和\cl                |
|  \v  |             匹配一个垂直制表符。等价于\x0b和\cK              |

## 1.3 特殊字符

这些字符有特殊含义，如果需要匹配他们，就需要转义

|        字符        |                             说明                             |
| :----------------: | :----------------------------------------------------------: |
|         $          |                  匹配输入字符串的结尾位置。                  |
|         ()         |               标记一个子表达式的开始和结束位置               |
|         *          |                 匹配前面的子表达式零次或多次                 |
|         +          |                 匹配前面的子表达式一次或多次                 |
| . (这里是英文小点) |                匹配除换行符\n之外的任何单字符                |
|         []         |                  标记一个中括号表达式的开始                  |
|         ?          |     匹配前面的子表达式零次或一次，或指明一个非贪婪限定符     |
|         \          |                             转义                             |
|         ^          | 匹配字符串的开始位置。在方括号中使用表示不接受该方括号中的字符集 |
|         {}         |                    标记限定符表达式的开始                    |
|         \|         |                    指明在两项之间选择一个                    |
|                    |                                                              |

## 1.4 限定符

| 字符  |              说明              |
| :---: | :----------------------------: |
|   *   |  匹配前面的子表达式零次或多次  |
|   +   | 匹配前面安的子表达式一次或多次 |
|   ?   |  匹配前面的子表达式零次或一次  |
|  {n}  |       n非负，匹配确定n次       |
| {n,}  |     n非负，匹配确定至少n次     |
| {n,m} |  n,m非负，匹配至少n次至多m次   |

`*`和`+`都是贪婪地，因为它们会尽可能多的匹配文字，只有在它们的后面加上一个`?`就可以实现非贪婪或最小匹配。

## 1.5 定位符

| 字符 |           说明           |
| :--: | :----------------------: |
|  ^   | 匹配输入字符串开始的位置 |
|  $   | 匹配输入字符串结尾的位置 |
|  \b  |     匹配一个单词边界     |
|  \B  |      匹配非单词边界      |

限定符与定位符不能一起使用。

## 1.6 选择

用圆括号`()`将所有选择项括起来，相邻的选择项之间用`|`分隔。

`()`表示捕获分组，`()`会把每个分组里的匹配的值保存起来，多个匹配值可以用过数字n来查看（n是一个数字，表示第n个捕获组的内容）

![](https://raw.githubusercontent.com/LiMuwenan/PicBed/master/img/dev/java/%E6%8D%95%E8%8E%B7%E5%88%86%E7%BB%84.PNG)

但用圆括号会有一个副作用，使相关的匹配会被缓存，此时可用 `?:` 放在第一个选项前来消除这种副作用。

其中`?:` 是非捕获元之一，还有两个非捕获元是 `?=` 和 `?!`，这两个还有更多的含义，前者为正向预查，在任何开始匹配圆括号内的正则表达式模式的位置来匹配搜索字符串，后者为负向预查，在任何开始不匹配该正则表达式模式的位置来匹配搜索字符串。

**以下列出 ?=、?<=、?!、?<! 的使用区别**

`exp1(>=exp2)`：查找exp2前的exp1

`(?<=exp2)exp1`：查找exp2后面的exp1

`exp1(?!exp2)`：查找后面不是exp2的exp1

`(?<!exp2)exp1`：查找前面不是exp2的exp1

## 1.7 反向引用

# 2 修饰符

标记也称为修饰符，正则表达式的标记用于指定额外的匹配策略。

标记不写在正则表达式里，写在外面：

```
/pattern/flags
```

| 修饰符 |              含义               |                             说明                             |
| :----: | :-----------------------------: | :----------------------------------------------------------: |
|   i    |       ignore-不区分大小写       |                   将匹配设置为不区分大小写                   |
|   g    |         global-全局匹配         |                        查找所有匹配项                        |
|   m    |       multi line-多行匹配       | 使边界字符`^`和`$`匹配每一行的开头和结尾，记住是多行，而不是整个字符串的开头和结尾 |
|   s    | 特殊字符圆点`.`中包含换行符`\n` | 默认情况下圆点`.`是匹配除换行符`\n`之外的任何字符，加上`s`修饰符之后，`.`中包含换行符`\n` |

# 3 元字符

[正则表达式 - 元字符](https://www.runoob.com/regexp/regexp-metachar.html)


![](https://raw.githubusercontent.com/LiMuwenan/PicBed/master/img/dev/java/%E9%82%AE%E7%AE%B1%E6%AD%A3%E5%88%99.PNG)

# 4 运算符优先级

|          运算符          |      说明      |
| :----------------------: | :------------: |
|            \             |    转义字符    |
|     (),(?:),(?=),[]      | 圆括号、方括号 |
|   *,+,?,{n},{n,},{n,m}   |     限定符     |
| ^,$,\任何元字符,任何字符 |  定位点和序列  |
|            \|            |    替换，或    |

# 5 Java正则表达式

`java.util.regex` 包主要包括以下三个类：

- **Pattern 类：**

  pattern 对象是一个正则表达式的编译表示。Pattern 类没有公共构造方法。要创建一个 Pattern 对象，你必须首先调用其公共静态编译方法，它返回一个 Pattern 对象。该方法接受一个正则表达式作为它的第一个参数。

- **Matcher 类：**

  Matcher 对象是对输入字符串进行解释和匹配操作的引擎。与Pattern 类一样，Matcher 也没有公共构造方法。你需要调用 Pattern 对象的 matcher 方法来获得一个 Matcher 对象。

- **PatternSyntaxException：**

  PatternSyntaxException 是一个非强制异常类，它表示一个正则表达式模式中的语法错误。

```java
import java.util.regex.*;
 
class RegexExample1{
   public static void main(String[] args){
      String content = "I am noob " +
        "from runoob.com.";
 	  //pattern是正则表达式
      String pattern = ".*runoob.*";
 	  
      //这里是pattern能个content匹配，而不是从content中查找pattern
      //如果删掉.*，则这里返回false
      boolean isMatch = Pattern.matches(pattern, content);
      System.out.println("字符串中是否包含了 'runoob' 子字符串? " + isMatch);
   }
}
```

## 5.1 捕获组

捕获组是把多个字符当一个单独单元进行处理的方法，它通过对括号内的字符分组来创建。

例如，正则表达式 (dog) 创建了单一分组，组里包含"d"，"o"，和"g"。

捕获组是通过从左至右计算其开括号来编号。例如，在表达式（（A）（B（C））），有四个这样的组：

- ((A)(B(C)))
- (A)
- (B(C))
- (C)

可以通过调用 matcher 对象的 groupCount 方法来查看表达式有多少个分组。groupCount 方法返回一个 int 值，表示matcher对象当前有多个捕获组。

还有一个特殊的组（group(0)），它总是代表整个表达式。该组不包括在 groupCount 的返回值中。

```java
import java.util.regex.Matcher;
import java.util.regex.Pattern;
 
public class RegexMatches
{
    public static void main( String[] args ){
 
      // 按指定模式在字符串查找
      String line = "This order was placed for QT3000! OK?";
      String pattern = "(\\D*)(\\d+)(.*)";//这里\\是正则中的\，先进行了反斜杠的转义
 
      // 创建 Pattern 对象
      Pattern r = Pattern.compile(pattern);
 
      // 现在创建 matcher 对象
      Matcher m = r.matcher(line);
      if (m.find( )) {
         System.out.println("Found value: " + m.group(0) );//Found value: This order was placed for QT3000! OK?
         System.out.println("Found value: " + m.group(1) );//Found value: This order was placed for QT
         System.out.println("Found value: " + m.group(2) );//Found value: 3000
         System.out.println("Found value: " + m.group(3) );//Found value: ! OK?
      } else {
         System.out.println("NO MATCH");
      }
   }
}
```

## 5.2 Matcher类的方法

### 5.2.1 索引方法

| **序号** | **方法及说明**                                               |
| :------- | :----------------------------------------------------------- |
| 1        | **public int start()** 返回以前匹配的初始索引。              |
| 2        | **public int start(int group)**  返回在以前的匹配操作期间，由给定组所捕获的子序列的初始索引 |
| 3        | **public int end()** 返回最后匹配字符之后的偏移量。          |
| 4        | **public int end(int group)** 返回在以前的匹配操作期间，由给定组所捕获子序列的最后字符之后的偏移量。 |

### 5.2.2 查找方法

| **序号** | **方法及说明**                                               |
| :------- | :----------------------------------------------------------- |
| 1        | **public boolean lookingAt()**  尝试将从区域开头开始的输入序列与该模式匹配。 |
| 2        | **public boolean find()** 尝试查找与该模式匹配的输入序列的下一个子序列。 |
| 3        | **public boolean find(int start****）** 重置此匹配器，然后尝试查找匹配该模式、从指定索引开始的输入序列的下一个子序列。 |
| 4        | **public boolean matches()** 尝试将整个区域与模式匹配。      |

### 5.2.3 替换方法

| **序号** | **方法及说明**                                               |
| :------- | :----------------------------------------------------------- |
| 1        | **public Matcher appendReplacement(StringBuffer sb, String replacement)** 实现非终端添加和替换步骤。 |
| 2        | **public StringBuffer appendTail(StringBuffer sb)** 实现终端添加和替换步骤。 |
| 3        | **public String replaceAll(String replacement)**  替换模式与给定替换字符串相匹配的输入序列的每个子序列。 |
| 4        | **public String replaceFirst(String replacement)**  替换模式与给定替换字符串匹配的输入序列的第一个子序列。 |
| 5        | **public static String quoteReplacement(String s)** 返回指定字符串的字面替换字符串。这个方法返回一个字符串，就像传递给Matcher类的appendReplacement 方法一个字面字符串一样工作。 |